# facial_recognition
　人物の写真を与えたときに、それがAさんかBさんか判定する、人物判定のプログラムです。

◆Cascades<br/>
　顔領域を認識するためのカスケード分類器(学習済)が入っているフォルダです。<br/>
OpenCVのGithubページ<br/>
https://github.com/opencv/opencv/tree/master/data/haarcascades<br/>
https://github.com/opencv/opencv/tree/master/data/lbpcascades<br/>
にある、Haar-like特徴を使った分類器とLBP特徴を使った分類器をここに入れてあります。使用する分類器を変えるときは、face_extraction.py内の変数cascade_pathを書き換えます。<br/>


◆Photos<br/>
　識別に使いたい人物の写真を入れておくフォルダです。ここでは一昔前に現役だったサッカー選手3人(ベッカム、ジダン、(ブラジルの)ロナウド)の写真を入れてあります。ジダンの写真はジダンフォルダ、ロナウドの写真はロナウドフォルダというように、人物ごとにフォルダが分かれています。<br/>

◆face_extraction.py<br/>
　Photosフォルダ内の画像から顔の部分を抽出⇒トリミングし、新しい画像ファイルとして保存するコードです。保存先は、新しく作られるextracted_faces_●●●(●●●には人物名が入る)フォルダになります。

　併せて、path_label.txtというテキストファイルが作られます。このテキストファイルには一行ずつ、新しい画像ファイルのパスと、当該画像ファイルに割り当てられたラベルが記載されています。ラベルは、たとえばベッカムなら0、ロナウドなら1というように、元の写真が納めれていたフォルダごとに番号が割り振られます。ラベリングの都合上、1枚の中に人物が1人だけ写っているものだけ抽出され、2人以上写っている写真からは抽出されません。

◆training.py<br/>
　抽出した顔画像ファイルを使ってトレーニングを行うコードです。ロナウドの画像にはロナウド(のラベル)、ジダンの画像にはジダン(のラベル)を返せるよう、学習していきます。<br/>

◆model.py<br/>
　画像データをクラス分類出力に変換するためのCNNモデルが記述されているコードです。<br/>
 
◆flags.py<br/>
　face_extraction.pyやtraining.pyで共通して使うパラメータを入れておくファイルです。Tensorflow1.4以前であればtf.app.flagsで引数を使うことができたのが、新しいバージョンでは使えなくなったので、代用するためのファイルです。<br/>

